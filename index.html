<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Compat Matrix â€“ Compare Browser Feature Support</title>
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' https://cdn.tailwindcss.com https://cdn.jsdelivr.net 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; connect-src 'self' https://raw.githubusercontent.com; font-src 'self' https://cdn.jsdelivr.net; object-src 'none'; base-uri 'self'; form-action 'self';">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/dompurify@3.1.5/dist/purify.min.js"></script>
  <script>
    tailwind.config = { darkMode: 'class' };
  </script>
</head>
<body class="bg-gray-100 dark:bg-[#1c202b] min-h-screen p-6">
  <a href="https://github.com/moritzglantz/compatmatrix" target="_blank" rel="noopener" title="View source on GitHub"
     class="fixed z-50 top-2.5 right-[-2.0rem] transform rotate-45 bg-blue-600 dark:bg-blue-500 text-white text-xs font-semibold px-8 py-2 shadow-lg hover:bg-blue-700 dark:hover:bg-blue-600 transition-colors"
     style="box-shadow:0 2px 8px rgba(0,0,0,0.08); border-radius:0 0 0 0.5rem; min-width:120px; text-align:center;">
    <svg class="w-4 h-4 inline mr-1 -ml-2" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true" style="vertical-align:middle;"><path d="M12 2C6.477 2 2 6.484 2 12.021c0 4.428 2.865 8.184 6.839 9.504.5.092.682-.217.682-.482 0-.237-.009-.868-.014-1.703-2.782.605-3.369-1.342-3.369-1.342-.454-1.154-1.11-1.462-1.11-1.462-.908-.62.069-.608.069-.608 1.004.07 1.532 1.032 1.532 1.032.892 1.53 2.341 1.088 2.91.832.091-.647.35-1.088.636-1.339-2.221-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.987 1.029-2.687-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.025A9.564 9.564 0 0 1 12 6.844c.85.004 1.705.115 2.504.337 1.909-1.295 2.748-1.025 2.748-1.025.546 1.378.202 2.397.1 2.65.64.7 1.028 1.594 1.028 2.687 0 3.847-2.337 4.695-4.566 4.944.359.309.678.919.678 1.853 0 1.337-.012 2.419-.012 2.749 0 .267.18.577.688.479C19.138 20.2 22 16.447 22 12.021 22 6.484 17.523 2 12 2z"/></svg>
    GitHub
  </a>
  <div class="max-w-6xl mx-auto bg-white dark:bg-gray-800 shadow-xl rounded-3xl p-6 space-y-6 relative">
    <h1 class="text-2xl font-bold text-gray-800 dark:text-gray-100">Compat Matrix</h1>
    <p>Compare browser feature support. Based on data of <a href="https://caniuse.com/" class="text-blue-600 dark:text-blue-400 underline hover:text-blue-800 dark:hover:text-blue-200 transition-colors">Can I use</a>. Supported means, any version of the said browser supports the feature. Even future ones.</p>

    <fieldset class="bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 p-6 pt-8 rounded-xl shadow-xs grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
      <legend class="w-full text-lg font-semibold text-gray-800 dark:text-gray-200 mb-6 pl-2">Browser and Category Filters</legend>
      <div class="flex flex-col">
        <label for="chrome" class="text-sm font-medium text-gray-700 dark:text-gray-300">Chrome</label>
        <select id="chrome" class="mt-1 h-10 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 px-4 py-2 text-sm placeholder-gray-500 focus:outline-none focus:ring-4 focus:ring-blue-500 focus:ring-opacity-50 focus:transition-shadow focus:duration-150 focus:ring-offset-1">
          <option>Any</option>
          <option>Yes</option>
          <option>No</option>
          <option>Partial</option>
        </select>
      </div>
      <div class="flex flex-col">
        <label for="firefox" class="text-sm font-medium text-gray-700 dark:text-gray-300">Firefox</label>
        <select id="firefox" class="mt-1 h-10 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 px-4 py-2 text-sm placeholder-gray-500 focus:outline-none focus:ring-4 focus:ring-blue-500 focus:ring-opacity-50 focus:transition-shadow focus:duration-150 focus:ring-offset-1">
          <option>Any</option>
          <option>Yes</option>
          <option>No</option>
          <option>Partial</option>
        </select>
      </div>
      <div class="flex flex-col">
        <label for="safari" class="text-sm font-medium text-gray-700 dark:text-gray-300">Safari</label>
        <select id="safari" class="mt-1 h-10 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 px-4 py-2 text-sm placeholder-gray-500 focus:outline-none focus:ring-4 focus:ring-blue-500 focus:ring-opacity-50 focus:transition-shadow focus:duration-150 focus:ring-offset-1">
          <option>Any</option>
          <option>Yes</option>
          <option>No</option>
          <option>Partial</option>
        </select>
      </div>
      <div class="flex flex-col">
        <label for="category" class="text-sm font-medium text-gray-700 dark:text-gray-300">Category</label>
        <select id="category" class="mt-1 h-10 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 px-4 py-2 text-sm placeholder-gray-500 focus:outline-none focus:ring-4 focus:ring-blue-500 focus:ring-opacity-50 focus:transition-shadow focus:duration-150 focus:ring-offset-1">
          <option>All Categories</option>
        </select>
      </div>
      <div class="flex flex-col flex-grow min-w-[200px] lg:col-span-2">
        <label for="filter-text" class="text-sm font-medium text-gray-700 dark:text-gray-300">Filter text</label>
        <input type="text" id="filter-text" placeholder="e.g. Audio" class="mt-1 h-10 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 px-4 py-2 text-sm placeholder-gray-500 focus:outline-none focus:ring-4 focus:ring-blue-500 focus:ring-opacity-50 focus:transition-shadow focus:duration-150 focus:ring-offset-1" />
      </div>
    </fieldset>

    <div class="text-sm text-gray-700 dark:text-gray-300">
      <output id="result-count" aria-live="polite">0 results</output>
    </div>

    <div class="overflow-x-auto overflow-hidden rounded-lg">
      <table class="min-w-full border-collapse text-sm caption-top">
        <caption class="text-lg font-semibold text-gray-800 dark:text-gray-200 mb-2">Feature support comparison for selected browsers</caption>
        <thead class="bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-200 uppercase text-xs tracking-wider">
          <tr>
            <th scope="col" class="sticky top-0 z-10 bg-gray-100 dark:bg-gray-700 rounded-tl-lg text-left px-4 py-3">Feature</th>
            <th scope="col" class="sticky top-0 z-10 bg-gray-100 dark:bg-gray-700 text-left px-4 py-3">Chrome</th>
            <th scope="col" class="sticky top-0 z-10 bg-gray-100 dark:bg-gray-700 text-left px-4 py-3">Firefox</th>
            <th scope="col" class="sticky top-0 z-10 bg-gray-100 dark:bg-gray-700 text-left px-4 py-3">Safari</th>
            <th scope="col" class="sticky top-0 z-10 bg-gray-100 dark:bg-gray-700 rounded-tr-lg text-left px-4 py-3">Description</th>
          </tr>
        </thead>
        <tbody class="text-gray-800 dark:text-gray-100">
          <tr class="border-b border-gray-200 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700">
            <td colspan="5" class="px-4 py-3">Loading...</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <script>
    let allFeatures = {};

    async function loadData() {
      try {
        const res = await fetch('https://raw.githubusercontent.com/Fyrd/caniuse/main/fulldata-json/data-2.0.json');
        if (!res.ok) throw new Error('Failed to fetch feature data');
        const json = await res.json();
        allFeatures = json.data ? Object.values(json.data) : [];
        normalizeCategories();
        populateCategories();
        renderTable();
      } catch (e) {
        console.error('Error loading feature data:', e);
        const tbody = document.querySelector('tbody');
        tbody.innerHTML = `<tr class="border-b border-gray-200 dark:border-gray-600"><td colspan="5" class="px-4 py-3 text-red-600">Error loading data: ${e.message}</td></tr>`;
      }
    }

    function normalizeCategories() {
      allFeatures.forEach(f => {
        if (!f.categories) return;
        f.categories = f.categories.map(cat => {
          if (cat.toLowerCase().startsWith('css')) return 'CSS';
          if (cat.toLowerCase() === 'html5') return 'HTML';
          return cat;
        });
      });
    }

    function populateCategories() {
      const cats = new Set();
      allFeatures.forEach(f => (f.categories || []).forEach(c => cats.add(c)));
      const sel = document.getElementById('category');
      sel.innerHTML = '<option>All Categories</option>';
      [...cats].sort().forEach(c => {
        const opt = document.createElement('option'); opt.value = c; opt.textContent = c; sel.append(opt);
      });
    }

    function renderMarkdown(str) {
      const dirty = str
        .replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;')
        .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
        .replace(/`([^`]+)`/g, '<code>$1</code>')
        .replace(/\[(.*?)\]\((.*?)\)/g, '<a href="$2" target="_blank" rel="noopener" class="text-blue-600 dark:text-blue-400 underline hover:text-blue-800 dark:hover:text-blue-200 transition-colors">$1</a>');
      return DOMPurify.sanitize(dirty, {ALLOWED_TAGS: ['strong','code','a'], ALLOWED_ATTR: ['href','target','rel','class']});
    }

    function statsToBadge(stats, browser) {
      const browserStats = stats && stats[browser] ? stats[browser] : {};
      const values = Object.values(browserStats).filter(v => typeof v === 'string');
      const supported = values.some(v => v.startsWith('y'));
      const partial = values.some(v => v.startsWith('a'));
      if (supported) {
        return `<span class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-emerald-500 dark:bg-emerald-700">
          <svg class="w-4 h-4 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" role="graphics-symbol">
            <title>Supported</title>
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
          </svg>
        </span>`;
      } else if (partial) {
        return `<span class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-yellow-400 dark:bg-yellow-600">
          <svg class="w-4 h-4 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" role="graphics-symbol">
            <title>Partial support</title>
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 12h12" />
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v12" opacity="0.3" />
          </svg>
        </span>`;
      } else {
        return `<span class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-rose-500 dark:bg-rose-700">
          <svg class="w-4 h-4 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" role="graphics-symbol">
            <title>Not supported</title>
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </span>`;
      }
    }

    function renderTable() {
      const countOut = document.getElementById('result-count');
      const tbody = document.querySelector('tbody');
      tbody.innerHTML = '';
      let count = 0;

      const cf = document.getElementById('chrome').value;
      const ff = document.getElementById('firefox').value;
      const sf = document.getElementById('safari').value;
      const cat = document.getElementById('category').value;
      const txt = document.getElementById('filter-text').value.trim().toLowerCase();

      allFeatures.forEach(feature => {
        if (!feature.stats || !feature.title) return;
        if (!feature.stats.chrome && !feature.stats.firefox && !feature.stats.safari) return;
        const title = typeof feature.title === 'string' ? feature.title : '';
        const desc = typeof feature.description === 'string' ? feature.description : '';
        const okCat = cat === 'All Categories' || (feature.categories || []).includes(cat);
        const okText = (!txt || title.toLowerCase().includes(txt) || desc.toLowerCase().includes(txt));
        if (okCat && okText && isSup(feature.stats, 'chrome', cf) && isSup(feature.stats, 'firefox', ff) && isSup(feature.stats, 'safari', sf)) {
          tbody.insertAdjacentHTML('beforeend', `
            <tr class="border-b border-gray-200 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700">
              <td class="px-4 py-3 font-medium">${title}</td>
              <td class="px-4 py-3 text-center">${statsToBadge(feature.stats, 'chrome')}</td>
              <td class="px-4 py-3 text-center">${statsToBadge(feature.stats, 'firefox')}</td>
              <td class="px-4 py-3 text-center">${statsToBadge(feature.stats, 'safari')}</td>
              <td class="px-4 py-3">${renderMarkdown(desc)}</td>
            </tr>
          `);
          count++;
        }
      });
      countOut.textContent = `${count} ${count === 1 ? 'result' : 'results'}`;
      if (count === 0) {
        tbody.innerHTML = `<tr class=\"border-b border-gray-200 dark:border-gray-600\"><td colspan=\"5\" class=\"px-4 py-3 text-gray-500 dark:text-gray-400\">No results</td></tr>`;
      }
    }

    function isSup(stats, browser, exp) {
      if (exp === 'Any') return true;
      const browserStats = stats && stats[browser] ? stats[browser] : {};
      const values = Object.values(browserStats).filter(v => typeof v === 'string');
      const hasYes = values.some(v => v.startsWith('y'));
      const hasPartial = values.some(v => v.startsWith('a'));
      if (exp === 'Yes') return hasYes;
      if (exp === 'No') return !hasYes && !hasPartial;
      if (exp === 'Partial') return hasPartial && !hasYes;
      return true;
    }

    window.addEventListener('DOMContentLoaded', async () => {
      ['chrome','firefox','safari'].forEach(id => {
        const sel = document.getElementById(id);
        if (sel && !Array.from(sel.options).some(o => o.value === 'Partial')) {
          const opt = document.createElement('option');
          opt.value = 'Partial';
          opt.textContent = 'Partial';
          sel.appendChild(opt);
        }
      });
      ['chrome','firefox','safari','category'].forEach(id => document.getElementById(id).addEventListener('change', renderTable));
      document.getElementById('filter-text').addEventListener('input', renderTable);
      await loadData();
    });
  </script>
  <!-- Matomo -->
    <script>
        var _paq = window._paq = window._paq || [];
        _paq.push(['trackEvent', 'Theme', 'Preference', (
			window.matchMedia &&
			window.matchMedia('(prefers-color-scheme: dark)').media !== 'not all'
				? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light')
				: 'unsupported'
		)]);
        _paq.push(['trackPageView']);
        _paq.push(['enableLinkTracking']);
        (function() {
        var u="https://m0g1.uber.space/piwik/";
        _paq.push(['setTrackerUrl', u+'matomo.php']);
        _paq.push(['setSiteId', '5']);
        var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
        g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
        })();
    </script>
    <noscript>
        <img referrerpolicy="no-referrer-when-downgrade" src="https://m0g1.uber.space/piwik/matomo.php?idsite=5&amp;rec=1" style="border:0" alt="" />
    </noscript>
    <!-- End Matomo Code -->
</body>
</html>
